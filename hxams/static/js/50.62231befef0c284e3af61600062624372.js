webpackJsonp([50],{"4PTk":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n#content[data-v-3d583bc8] img {\n  display: block;\n  width: 80%;\n}\n#content[data-v-3d583bc8] em {\n  font-style: italic;\n}\n.browse-container[data-v-3d583bc8] {\n  width: 100%;\n  min-height: 380px;\n  height: 60vh;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0 30px;\n}\n.browse-container h4[data-v-3d583bc8] {\n    text-align: center;\n    font-size: 18px;\n    color: #333;\n    margin: 10px 0px;\n}\n.browse-container .title[data-v-3d583bc8] {\n    margin: 15px;\n}\n.browse-container #content[data-v-3d583bc8] {\n    color: #666;\n    width: 96%;\n    text-indent: 20px;\n    margin: 0 2% 30px;\n}\n#content[data-v-3d583bc8] .ql-align-center {\n  text-align: center;\n}\n#content[data-v-3d583bc8] .ql-align-right {\n  text-align: right;\n}\n",""])},B1vF:function(e,t,n){var a=n("M66x");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("14f16dcc",a,!1,{})},DXUD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"browse-container",domProps:{innerHTML:this._s(this.selectDeceive)}})};a._withStripped=!0;var i={render:a,staticRenderFns:[]},o=i;var c=!1;var r=n("VU/8")({name:"LackOfMaterialsList",components:{},props:["selectDeceive"],data:function(){return{browseItem:{}}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},o,!1,function(e){c||n("L0D5")},"data-v-3d583bc8",null);r.options.__file="src/views/archivesSpecialVerification/statisticalAnalysis/LackOfMaterialsList.vue";var l=r.exports,s=(n("g7ZD"),{name:"MaterialNameSelect",props:["chioceOptionId"],data:function(){return{dataList:[],chioceId:this.chioceOptionId}},computed:{},created:function(){this.getData()},methods:{changeChioceId:function(e){this.chioceId=e,this.$emit("MaterialNameSelectCall",e)},getData:function(){var e=this;this.$axios({loading:{isShow:!1},method:"get",url:this.API.tenTree}).then(function(t){var n=t.data;"1"==n.code?(e.dataList=n.data,e.chioceOptionId&&e.chioceOptionId.length>0&&(e.chioceId=e.chioceOptionId,e.$emit("MaterialNameSelectCall",e.chioceId))):e.$message({type:"error",message:"获取下拉框数据失败，请刷新重试！"})}).catch(function(t){e.$message({type:"error",message:"请求异常，请检查网络！"})})}},mounted:function(){}}),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"MaterialNameSelect"},[n("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.changeChioceId},model:{value:e.chioceOptionId,callback:function(t){e.chioceOptionId=t},expression:"chioceOptionId"}},e._l(e.dataList,function(e){return n("el-option",{key:e.code,attrs:{label:e.describe,value:e.code}})}),1)],1)};d._withStripped=!0;var h={render:d,staticRenderFns:[]},p=h;var f=!1;var m=n("VU/8")(s,p,!1,function(e){f||n("B1vF")},"data-v-8ad241c4",null);m.options.__file="src/components/MaterialNameSelect.vue";var u={name:"statisticalAnalysis",components:{LackOfMaterialsList:l,MaterialNameSelect:m.exports},data:function(){return{formInline:{a0101:"",codeno:""},tableData:[],pageObj:{pageIndex:this.API.constObj.pageIndex,total:0,pageSize:this.API.constObj.pageSize},tableHeight:"",lack_materials:!1,chioceObj:"",a0100:"",batchNo:"",multipleSelection:[]}},created:function(){this.getPagerE01Z500Json()},mounted:function(){},watch:{tableData:{handler:function(e){this.tableHeight=window.innerHeight-this.$refs.table.$el.offsetTop-40-70-20}}},methods:{getDataTable:function(){this.getPagerE01Z500Json()},handleSelectionChange:function(e){this.multipleSelection=e;var t="",n="";this.multipleSelection.forEach(function(e){""==t?t=e.batchNo:t+=","+e.batchNo,""==n?n=e.a0100:n+=","+e.a0100}),this.batchNo=t,this.a0100=n},exportExcel:function(){this.multipleSelection.length>0?this.$axios({method:"get",url:this.API.exportExcel,responseType:"arraybuffer",headers:{"Content-Type":"bin",batchno:this.batchNo},params:{batchNo:this.batchNo,a0100:this.a0100}}).then(function(e){this.fileDownload(e.data,"统计导出.zip")}.bind(this)).catch(function(e){this.$message({type:"error",message:"获取失败，请刷新！"})}.bind(this)):this.$confirm("请选择人员！","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning",center:!0})},fileDownload:function(e,t){var n=new Blob([e],{type:"application/octet-stream"}),a=t||"filename.zip";if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,a);else{var i=window.URL.createObjectURL(n),o=document.createElement("a");o.style.display="none",o.href=i,o.setAttribute("download",a),void 0===o.download&&o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)}},getDetails:function(e){var t=this,n="";this.$axios({loading:{isShow:!0,target:"#statisticalAnalysis"},method:"post",url:this.API.queryByUser,data:{batchNo:e}}).then(function(e){var a=e.data;"1"==a.code?a.data.forEach(function(e,a){""==n?n="<p>"+(a+1)+"、"+e.e01z111a+"<p>":n+="<p>"+(a+1)+"、"+e.e01z111a+"<p>",t.chioceObj=n,t.lack_materials=!0}):t.$message({type:"error",message:"获取失败，请刷新！"})}).catch(function(e){t.$message({type:"error",message:"请求异常，请检查网络！"})})},getPagerE01Z500Json:function(){var e=this;this.$axios({loading:{isShow:!0,target:"#statisticalAnalysis"},method:"post",url:this.API.queryAllUser,data:this.formInline}).then(function(t){var n=t.data;"1"==n.code?e.tableData=n.data:e.$message({type:"error",message:"获取失败，请刷新！"})}).catch(function(t){e.$message({type:"error",message:"请求异常，请检查网络！"})})},search:function(){0!=Number(this.searchForm.endDateStr)&&Number(this.searchForm.startDateStr)>Number(this.searchForm.endDateStr)?this.$message({type:"error",message:"请书写正确的日期时段！"}):(this.pageObj.pageIndex=this.API.constObj.pageIndex,this.getPagerE01Z500Json())},BrowsePersonal:function(e,t){this.chioceObj=this.cadreInformationList[e],this.browse_personal=!0},MaterialNameSelectCall:function(e){this.formInline.codeno=e}}},b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"archives-receive-containers",attrs:{id:"statisticalAnalysis"}},[n("el-container",{attrs:{id:"recycTable"}},[n("el-main",[n("div",{staticClass:"title"},[n("div",{staticClass:"left"}),e._v(" "),n("div",{staticClass:"right"},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:"姓名"}},[n("el-input",{model:{value:e.formInline.a0101,callback:function(t){e.$set(e.formInline,"a0101",t)},expression:"formInline.a0101"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"材料名称"}},[n("MaterialNameSelect",{attrs:{chioceOptionId:e.formInline.codeno},on:{MaterialNameSelectCall:e.MaterialNameSelectCall}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.getDataTable}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1)],1)],1)]),e._v(" "),n("el-table",{ref:"table",staticStyle:{width:"100%",height:"100%"},attrs:{height:e.tableHeight,data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"a0101",label:"姓名",width:"120",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"a0104A",label:"性别",width:"120",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"a0111A",label:"籍贯",width:"200",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"a0192A",label:"单位职务",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"batchNo",label:"材料名称",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.getDetails(t.row.batchNo)}}},[e._v("详情")])]}}])})],1)],1),e._v(" "),e.lack_materials?n("el-dialog",{attrs:{title:"缺少材料清单",width:"600px",visible:e.lack_materials,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.lack_materials=t}}},[n("LackOfMaterialsList",{attrs:{selectDeceive:e.chioceObj}})],1):e._e()],1)],1)};b._withStripped=!0;var v={render:b,staticRenderFns:[]},g=v;var x=!1;var w=n("VU/8")(u,g,!1,function(e){x||n("PZge")},null,null);w.options.__file="src/views/archivesSpecialVerification/statisticalAnalysis/statisticalAnalysis.vue";t.default=w.exports},L0D5:function(e,t,n){var a=n("4PTk");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("68a96615",a,!1,{})},M66x:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.MaterialNameSelect .el-select[data-v-8ad241c4] {\n  width: 100%;\n}\n[data-v-8ad241c4] .el-scrollbar__view {\n  width: 280px !important;\n}\n",""])},PZge:function(e,t,n){var a=n("eQRV");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("fac89788",a,!1,{})},eQRV:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.archives-receive-containers {\n  position: relative;\n}\n.archives-receive-containers /deep/ .el-form-item--small {\n    margin-bottom: 0;\n}\n.archives-receive-containers .top {\n    margin: 10px;\n}\n.archives-receive-containers .el-container {\n    background-color: #fff;\n}\n.archives-receive-containers .el-container .el-main {\n      padding: 0;\n}\n.archives-receive-containers .el-container .el-dialog {\n      height: 100%;\n}\n.archives-receive-containers .el-container .title {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: justify;\n          -ms-flex-pack: justify;\n              justify-content: space-between;\n      padding: 10px;\n}\n.archives-receive-containers .el-container .title .left {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        float: left;\n}\n.archives-receive-containers .el-container .title .right {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-flex: right;\n            -ms-flex: right;\n                flex: right;\n}\n.archives-receive-containers .el-container .title .right .el-input {\n          margin-right: 10px;\n}\n.archives-receive-containers .el-container .material_page {\n      margin-top: 10px;\n      text-align: right;\n}\n.archives-receive-containers .el-container .el-dialog {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin: 0 !important;\n      -webkit-transform: translate(-50%, -50%);\n              transform: translate(-50%, -50%);\n      max-height: calc(100% - 30px);\n      max-width: calc(100% - 30px);\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-orient: vertical;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: column;\n              flex-direction: column;\n      background-color: #fff;\n}\n.archives-receive-containers .el-container .el-dialog .el-dialog__body {\n        overflow: auto;\n}\n",""])}});